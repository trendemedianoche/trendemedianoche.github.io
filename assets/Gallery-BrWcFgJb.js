import{s as u,r as s,j as n}from"./index--YzB5bQJ.js";const I="trendemedianoche_assets";async function f(){const{data:e,error:i}=await u.from("gallery_images").select("*").eq("active",!0).order("position",{ascending:!0});return i?(console.error(i),[]):(await Promise.all(e.map(async l=>{const{data:d,error:o}=await u.storage.from(I).createSignedUrl(l.path,3600);return o?(console.error(o),null):{...l,url:d.signedUrl}}))).filter(Boolean)}function j(){const[e,i]=s.useState([]),[a,l]=s.useState(null),[d,o]=s.useState(0);s.useEffect(()=>{f().then(i)},[]);const m=()=>{l(null)},h=()=>{if(!a)return;const t=(e.findIndex(g=>g.id===a.id)+1)%e.length;l(e[t])},x=()=>{if(!a)return;const t=(e.findIndex(g=>g.id===a.id)-1+e.length)%e.length;l(e[t])},c=e.length?e[d%e.length]:null;return s.useEffect(()=>{if(!e.length)return;const r=setInterval(()=>{o(t=>(t+1)%e.length)},3e3);return()=>clearInterval(r)},[e.length]),n.jsxs(n.Fragment,{children:[n.jsx("section",{id:"media",className:"gallery-section",children:c&&n.jsx("div",{className:"media-cta-container",style:{backgroundImage:`url(${c.url})`},onClick:()=>l(c),role:"button","aria-label":"Ver foto",children:n.jsx("div",{className:"media-cta-overlay",onClick:()=>l(c)})})}),a&&n.jsx("div",{className:"gallery-modal",onClick:m,children:n.jsxs("div",{className:"gallery-modal-content",onClick:r=>r.stopPropagation(),children:[n.jsx("button",{className:"gallery-modal-close",onClick:m,children:"✕"}),n.jsx("div",{className:"gallery-modal-image-container",children:n.jsx("img",{src:a.url,alt:a.alt||"Tren de Medianoche",className:"gallery-modal-image"})}),n.jsxs("div",{className:"gallery-modal-controls",children:[n.jsx("button",{className:"gallery-nav-btn gallery-nav-prev",onClick:x,title:"Imagen anterior",children:"◀"}),n.jsxs("div",{className:"gallery-modal-info",children:[n.jsx("span",{children:e.findIndex(r=>r.id===a.id)+1}),n.jsx("span",{children:"/"}),n.jsx("span",{children:e.length})]}),n.jsx("button",{className:"gallery-nav-btn gallery-nav-next",onClick:h,title:"Siguiente imagen",children:"▶"})]})]})})]})}export{j as default};

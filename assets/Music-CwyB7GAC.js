import{s as i,r as l,j as s}from"./index-DwFGreWk.js";const o="trendemedianoche_assets";async function n(){try{const{data:e,error:r}=await i.from("songs").select("*").eq("is_active",!0).order("created_at",{ascending:!1}).limit(1).single();if(r||!e)return null;const{data:t}=await i.storage.from(o).createSignedUrl(e.storage_path,3600);let a=null;if(e.cover_path){const{data:c}=await i.storage.from(o).createSignedUrl(e.cover_path,3600);a=c?.signedUrl||null}return{...e,audioUrl:t?.signedUrl||null,coverUrl:a}}catch(e){return console.error("Music load error:",e),null}}function u(){const[e,r]=l.useState(null),[t,a]=l.useState(!1);return l.useEffect(()=>{n().then(r)},[]),s.jsxs("section",{id:"music",className:"music-section",children:[s.jsx("h2",{className:"section-title",children:"Música"}),e?.audioUrl&&!t&&s.jsxs("div",{className:"release-spotlight",children:[e.coverUrl&&s.jsx("div",{className:"release-cover",children:s.jsx("img",{src:e.coverUrl,alt:`Portada ${e.title}`})}),s.jsxs("div",{className:"release-content",children:[s.jsxs("div",{className:"release-meta",children:[s.jsx("span",{className:"release-label",children:"Último lanzamiento"}),s.jsx("h3",{className:"release-title",children:e.title}),s.jsxs("p",{className:"release-subtitle",children:[e.album," · ",e.artist]})]}),s.jsxs("audio",{controls:!0,preload:"metadata",onError:()=>a(!0),children:[s.jsx("source",{src:e.audioUrl,type:"audio/mpeg"}),"Tu navegador no soporta audio."]})]})]}),s.jsxs("div",{className:"music-card spotify-card",children:[s.jsx("h3",{children:"Escúchanos en Spotify"}),s.jsx("iframe",{src:"https://open.spotify.com/embed/artist/2ZRyGZfKgNjNKbry4Aqv7J?theme=0",width:"100%",height:"352",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})]})]})}export{u as default};

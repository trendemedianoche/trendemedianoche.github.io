import{s as o,r as t,j as s}from"./index-Cp-hMQzp.js";const c="trendemedianoche_assets";async function h(){try{const{data:e,error:l}=await o.from("songs").select("*").eq("is_active",!0).order("created_at",{ascending:!1}).limit(1).single();if(l||!e)return null;const{data:i}=await o.storage.from(c).createSignedUrl(e.storage_path,3600);let r=null;if(e.cover_path){const{data:a}=await o.storage.from(c).createSignedUrl(e.cover_path,3600);r=a?.signedUrl||null}return{...e,audioUrl:i?.signedUrl||null,coverUrl:r}}catch(e){return console.error("Music load error:",e),null}}function f(){const[e,l]=t.useState(null),[i,r]=t.useState(!1),[a,n]=t.useState(!1),[d,u]=t.useState(!0);return t.useEffect(()=>{h().then(l);const m=setTimeout(()=>{a||u(!1)},3e3);return()=>clearTimeout(m)},[a]),s.jsxs("section",{id:"music",className:"music-section",children:[s.jsx("h2",{className:"section-title",children:"Música"}),e?.audioUrl&&!i&&s.jsxs("div",{className:"release-spotlight",children:[e.coverUrl&&s.jsx("div",{className:"release-cover",children:s.jsx("img",{src:e.coverUrl,alt:e.title})}),s.jsxs("div",{className:"release-content",children:[s.jsxs("div",{className:"release-meta",children:[s.jsx("span",{className:"release-label",children:"Último lanzamiento"}),s.jsx("h3",{className:"release-title",children:e.title}),s.jsxs("p",{className:"release-subtitle",children:[e.album," · ",e.artist]})]}),s.jsx("audio",{controls:!0,preload:"metadata",onError:()=>r(!0),children:s.jsx("source",{src:e.audioUrl,type:"audio/mpeg"})})]})]}),d&&s.jsxs("div",{className:"music-card spotify-card",children:[s.jsx("h3",{children:"Escúchanos en Spotify"}),s.jsx("iframe",{src:"https://open.spotify.com/embed/artist/2ZRyGZfKgNjNKbry4Aqv7J?theme=0",width:"100%",height:"352",loading:"lazy",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",style:{border:"none"},onLoad:()=>n(!0)})]})]})}export{f as default};

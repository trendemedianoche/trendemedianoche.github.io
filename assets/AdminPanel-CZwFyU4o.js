import{r as c,j as e,s as k,u as q}from"./index-Cp-hMQzp.js";import{g as $,u as P,c as V,d as G}from"./newsService-BhxI1kZM.js";import{g as H,u as I,c as O,d as U}from"./extraNewsService-LcgbcX8o.js";import{c as W,u as M,r as K,d as J,e as Q,f as B,t as F,h as R}from"./donationService-BFFx6Yzt.js";import{g as X,m as Y,d as Z}from"./chatService-CkDy17S7.js";import{g as ee,u as te}from"./aboutService-B8EgkYZ-.js";const T="trendemedianoche_assets";function ae(){const[s,j]=c.useState([]),[u,h]=c.useState(null),[n,o]=c.useState(""),[d,t]=c.useState(""),[m,x]=c.useState(!1),p=c.useRef(null),y=a=>{const b=a.split("/").pop();return b.length>20?`${b.slice(0,12)}â€¦${b.slice(-6)}`:b},S=async()=>{x(!0);const{data:a,error:b}=await k.from("gallery_images").select("*").order("position",{ascending:!0});if(b){o("Error cargando imÃ¡genes"),t("error"),x(!1);return}const f=await Promise.all(a.map(async N=>{const{data:E}=await k.storage.from(T).createSignedUrl(N.path,3600);return E?{...N,url:E.signedUrl}:null}));j(f.filter(Boolean)),x(!1)};c.useEffect(()=>{S()},[]);const r=async()=>{if(!u){o("Selecciona una imagen"),t("error");return}x(!0);const a=`images/${Date.now()}-${u.name}`,{error:b}=await k.storage.from(T).upload(a,u);if(b){o(b.message),t("error"),x(!1);return}const f=Math.max(0,...s.map(N=>N.position||0));await k.from("gallery_images").insert({path:a,position:f+1,active:!0}),h(null),o("âœ“ Imagen subida correctamente"),t("success"),p.current&&(p.current.value=""),S()},l=async a=>{x(!0),await k.from("gallery_images").update({active:!a.active}).eq("id",a.id),S()},g=async(a,b)=>{const f=a+b;if(f<0||f>=s.length)return;const N=s[a],E=s[f];x(!0),await k.from("gallery_images").update({position:-1}).eq("id",N.id),await k.from("gallery_images").update({position:N.position}).eq("id",E.id),await k.from("gallery_images").update({position:E.position}).eq("id",N.id),S()},w=async a=>{window.confirm("Â¿Eliminar esta imagen?")&&(x(!0),await k.storage.from(T).remove([a.path]),await k.from("gallery_images").delete().eq("id",a.id),o("âœ“ Imagen eliminada"),t("success"),S())};return e.jsxs("div",{children:[n&&e.jsx("div",{className:`admin-alert alert-${d}`,children:n}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:" GalerÃ­a"})}),e.jsx("div",{className:"admin-card-body",children:e.jsxs("div",{className:"admin-form",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"photo-upload",children:"Seleccionar Imagen"}),e.jsx("input",{id:"photo-upload",type:"file",ref:p,onChange:a=>h(a.target.files?.[0]||null),disabled:m,accept:"image/*"})]}),u&&e.jsxs("div",{className:"item-card",style:{borderLeft:"4px solid #00a300"},children:[e.jsx("strong",{children:"Archivo seleccionado:"}),e.jsx("p",{children:y(u.name)})]}),e.jsx("button",{className:"btn btn-primary btn-block",onClick:r,disabled:!u||m,children:m?"â³ Subiendo...":"ðŸ“¤ Subir Imagen"})]})})]}),e.jsxs("div",{className:"admin-card",style:{marginTop:"2rem"},children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:["ImÃ¡genes (",s.length,")"]})}),s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay imÃ¡genes en la galerÃ­a"})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1.5rem",padding:"1.5rem"},children:s.map((a,b)=>e.jsxs("div",{className:"item-card",style:{display:"flex",flexDirection:"column",padding:"1rem",background:"linear-gradient(180deg, #1a1a1a, #0f0f0f)",border:"1px solid #333",borderRadius:"8px"},children:[a.url&&e.jsx("img",{src:a.url,alt:a.path,style:{width:"100%",height:"180px",objectFit:"cover",borderRadius:"6px",marginBottom:"1rem",opacity:a.active?1:.5,border:a.active?"2px solid #f5c400":"2px solid #555"}}),e.jsxs("div",{style:{marginBottom:"0.8rem"},children:[e.jsx("strong",{style:{fontSize:"0.9rem",color:"#f5f5f5"},children:y(a.path)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.3rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"#aaa"},children:new Date(a.created_at).toLocaleDateString()}),!a.active&&e.jsx("span",{className:"badge badge-inactive",style:{fontSize:"0.7rem",padding:"0.2rem 0.5rem",background:"rgba(255,0,0,0.2)",color:"#ff6b6b",borderRadius:"4px"},children:"Inactiva"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,-1),disabled:m||b===0,title:"Mover a la izquierda",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"â¬…"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,1),disabled:m||b===s.length-1,title:"Mover a la derecha",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"âž¡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>l(a),disabled:m,title:a.active?"Ocultar imagen":"Mostrar imagen",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:a.active?"ðŸ‘":"ðŸš«"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>w(a),disabled:m,title:"Eliminar imagen",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"ðŸ—‘"})]})]},a.id))})]})]})}function se({activeTab:s,setActiveTab:j,role:u}){const{user:h}=q(),[n,o]=c.useState(null);c.useEffect(()=>{h&&d()},[h]);const d=async()=>{const{data:p}=await k.from("profiles").select("name, role").eq("id",h.id).single();p&&o(p)},t=async()=>{await k.auth.signOut(),window.location.href="/#/login"},m=n?.name||h?.email?.split("@")[0]||"Admin",x=n?.role==="admin"?"Administrador":"Usuario";return e.jsxs("header",{className:"admin-header-modern",children:[e.jsxs("div",{className:"admin-header-left",children:[e.jsxs("div",{className:"admin-logo-combo",children:[e.jsx("div",{className:"admin-logo-icon"}),e.jsx("div",{className:"admin-logo-text"})]}),e.jsxs("div",{className:"admin-title-section",children:[e.jsx("h1",{className:"admin-title",children:"Panel de Control"}),e.jsx("p",{className:"admin-subtitle",children:"GestiÃ³n de Contenido"})]})]}),e.jsxs("div",{className:"admin-header-right",children:[e.jsxs("div",{className:"admin-user-info",children:[e.jsx("span",{className:"user-icon",children:"ðŸ‘¤"}),e.jsxs("div",{className:"user-details",children:[e.jsx("span",{className:"user-name",children:m}),e.jsx("span",{className:"user-role",children:x})]})]}),e.jsx("button",{className:"logout-btn",onClick:t,children:"ðŸšª Cerrar sesiÃ³n"})]})]})}function ne(){const[s,j]=c.useState([]),[u,h]=c.useState(null),[n,o]=c.useState(!1),[d,t]=c.useState({title:"",content:"",date:""}),m=async()=>{o(!0);const r=await $();j(r),o(!1)};c.useEffect(()=>{m()},[]);const x=()=>{h(null),t({title:"",content:"",date:""})},p=async r=>{r.preventDefault(),o(!0),u?await P(u.id,d):await V(d),x(),m()},y=r=>{h(r),t({title:r.title,content:r.content,date:r.date})},S=async r=>{window.confirm("Â¿Eliminar noticia?")&&(o(!0),await G(r),m())};return e.jsxs("div",{className:"news-admin-container",children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:u?"âœï¸ Editar":" Nueva Noticia"})}),e.jsxs("form",{className:"admin-form",onSubmit:p,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title",children:"TÃ­tulo"}),e.jsx("input",{id:"title",type:"text",placeholder:"TÃ­tulo de la noticia",value:d.title,onChange:r=>t({...d,title:r.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"content",children:"Contenido"}),e.jsx("textarea",{id:"content",placeholder:"Contenido de la noticia",value:d.content,onChange:r=>t({...d,content:r.target.value}),required:!0,style:{minHeight:"150px"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"date",children:"Fecha"}),e.jsx("input",{id:"date",type:"date",value:d.date,onChange:r=>t({...d,date:r.target.value}),required:!0})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn btn-primary btn-block",disabled:n,children:n?"â³ Guardando...":u?"âœ“ Actualizar":"âœ“ Crear"}),u&&e.jsx("button",{type:"button",className:"btn btn-secondary btn-block",onClick:x,children:"âœ• Cancelar"})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:[" Noticias (",s.length,")"]})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay noticias"})]}):e.jsx("div",{className:"admin-card-body",children:s.map(r=>e.jsxs("div",{className:"item-card",children:[e.jsx("div",{className:"item-header",children:e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#f5c400"},children:r.title}),e.jsx("p",{style:{margin:"0.4rem 0 0 0",color:"#bbb",fontSize:"0.85rem"},children:r.date})]})}),e.jsxs("p",{style:{margin:"0.8rem 0",fontSize:"0.9rem",color:"#ddd",lineHeight:"1.5"},children:[r.content.substring(0,100),"..."]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>y(r),disabled:n,children:"âœï¸ Editar"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>S(r.id),disabled:n,children:"ðŸ—‘ Eliminar"})]})]},r.id))})]})]})}function ie(){const[s,j]=c.useState([]),[u,h]=c.useState(null),[n,o]=c.useState(!1),[d,t]=c.useState({icon:"",content:"",active:!0}),m=async()=>{o(!0);const l=await H();j(l),o(!1)};c.useEffect(()=>{m()},[]);const x=async l=>{if(l.preventDefault(),o(!0),u)await I(u.id,d);else{const g=s.length>0?Math.max(...s.map(w=>w.position))+1:1;await O({...d,position:g})}t({icon:"",content:"",active:!0}),h(null),m()},p=l=>{h(l),t({icon:l.icon,content:l.content,active:l.active})},y=async l=>{window.confirm("Â¿Eliminar?")&&(o(!0),await U(l),m())},S=async l=>{o(!0),await I(l.id,{active:!l.active}),m()},r=async(l,g)=>{const w=l+g;if(w<0||w>=s.length)return;const a=s[l],b=s[w];o(!0),await I(a.id,{position:-1}),await I(b.id,{position:a.position}),await I(a.id,{position:b.position}),m()};return e.jsxs("div",{className:"news-admin-container",children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:u?"âœï¸ Editar":" Nueva Extra"})}),e.jsxs("form",{className:"admin-form",onSubmit:x,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"icon",children:"Icono"}),e.jsx("input",{id:"icon",type:"text",placeholder:"Ej: ðŸ”¥ ðŸ“… âš¡",value:d.icon,onChange:l=>t({...d,icon:l.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"content",children:"Contenido"}),e.jsx("textarea",{id:"content",placeholder:"Contenido del anuncio",value:d.content,onChange:l=>t({...d,content:l.target.value}),required:!0,style:{minHeight:"100px"}})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.95rem",color:"#f5c400",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:d.active,onChange:l=>t({...d,active:l.target.checked})}),"Activo"]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn btn-primary btn-block",disabled:n,children:n?"â³ Guardando...":u?"âœ“ Actualizar":"âœ“ Crear"}),u&&e.jsx("button",{type:"button",className:"btn btn-secondary btn-block",onClick:()=>{h(null),t({icon:"",content:"",active:!0})},children:"âœ• Cancelar"})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:[" Extra (",s.length,")"]})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay extras"})]}):e.jsx("div",{className:"admin-card-body",children:s.map((l,g)=>e.jsxs("div",{className:"item-card",children:[e.jsx("div",{className:"item-header",children:e.jsxs("div",{children:[e.jsxs("strong",{style:{color:"#f5c400",fontSize:"1.1rem"},children:[l.icon," ",l.content.substring(0,40),"..."]}),!l.active&&e.jsx("span",{className:"badge badge-inactive",children:"Inactivo"})]})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(g,-1),disabled:n||g===0,title:"Subir",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(g,1),disabled:n||g===s.length-1,title:"Bajar",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>S(l),disabled:n,children:l.active?"ðŸ‘":"ðŸš«"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>p(l),disabled:n,children:"âœï¸"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>y(l.id),disabled:n,children:"ðŸ—‘"})]})]},l.id))})]})]})}function le(){const[s,j]=c.useState([]),[u,h]=c.useState(null),[n,o]=c.useState(!1),[d,t]=c.useState(null),[m,x]=c.useState("");c.useEffect(()=>{p()},[]);const p=async()=>{o(!0);const a=await W();j(a.fields),h(a.methodId),o(!1)},y=async a=>{o(!0),await M(a.id,{visible:!a.visible}),p()},S=async(a,b)=>{o(!0),await M(a,{field_value:b}),t(null),x(""),p()},r=a=>{t(a.id),x(a.field_value)},l=()=>{t(null),x("")},g=async(a,b)=>{const f=[...s],N=a+b;N<0||N>=f.length||([f[a],f[N]]=[f[N],f[a]],o(!0),j(f),await K(f),p())},w=async a=>{window.confirm("Â¿Eliminar campo?")&&(o(!0),await J(a),p())};return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:["ðŸ’° Datos de DonaciÃ³n (",s.length,")"]})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:"ðŸ’³"}),e.jsx("p",{className:"empty-state-text",children:"No hay datos de donaciÃ³n configurados"})]}):e.jsx("div",{className:"admin-card-body",children:s.map((a,b)=>e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#f5c400",fontSize:"0.9rem"},children:a.field_key}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",value:d===a.id?m:a.field_value,onChange:f=>x(f.target.value),disabled:d!==a.id,style:{flex:1,padding:"0.6rem",border:"1px solid #333",background:d===a.id?"#1a1a1a":"#0d0d0d",color:"#f5f5f5",borderRadius:"4px",fontSize:"0.95rem",opacity:d===a.id?1:.7}}),d===a.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>S(a.id,m),disabled:n,title:"Guardar",children:"ðŸ’¾"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:l,disabled:n,title:"Cancelar",children:"âœ•"})]}):e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>r(a),disabled:n||d!==null,title:"Editar",children:"âœï¸"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,-1),disabled:n||b===0,title:"Subir",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,1),disabled:n||b===s.length-1,title:"Bajar",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>y(a),disabled:n,title:a.visible?"Visible":"Oculto",children:a.visible?"ðŸ‘":"ðŸš«"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>w(a.id),disabled:n,title:"Eliminar",children:"ðŸ—‘"})]})]},a.id))})]})}function re(){const[s,j]=c.useState([]),[u,h]=c.useState([]),[n,o]=c.useState(!1),[d,t]=c.useState(null),[m,x]=c.useState(""),[p,y]=c.useState(null),[S,r]=c.useState("");c.useEffect(()=>{l()},[]);const l=async()=>{o(!0);const i=await Q(),C=i.filter(A=>["email","phone"].includes(A.type)),v=i.filter(A=>A.type==="social");j(C),h(v),o(!1)},g=i=>{t(i.id),x(i.url)},w=()=>{t(null),x("")},a=async(i,C)=>{o(!0),await B(i,{url:C}),t(null),x(""),l()},b=async i=>{o(!0),await F(i.id,!i.active),l()},f=async(i,C)=>{const v=[...s],A=i+C;A<0||A>=v.length||([v[i],v[A]]=[v[A],v[i]],o(!0),j(v),await R(v),l())},N=i=>{y(i.id),r(i.url)},E=()=>{y(null),r("")},_=async(i,C)=>{o(!0),await B(i,{url:C}),y(null),r(""),l()},L=async i=>{o(!0),await F(i.id,!i.active),l()},z=async(i,C)=>{const v=[...u],A=i+C;A<0||A>=v.length||([v[i],v[A]]=[v[A],v[i]],o(!0),h(v),await R(v),l())};return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:"âš™ï¸ ConfiguraciÃ³n del Footer"})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):e.jsxs("div",{className:"admin-card-body",children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{color:"#f5c400",fontSize:"1.1rem",marginBottom:"1rem",borderBottom:"1px solid #333",paddingBottom:"0.5rem"},children:["ðŸ“§ Datos de Contacto (",s.length,")"]}),s.length===0?e.jsx("p",{style:{color:"#888",fontSize:"0.9rem"},children:"No hay datos de contacto configurados"}):s.map((i,C)=>e.jsxs("div",{className:"item-card",style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#f5c400",fontSize:"0.9rem"},children:i.name}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",value:d===i.id?m:i.url,onChange:v=>x(v.target.value),disabled:d!==i.id,placeholder:i.type==="email"?"correo@ejemplo.com":"56912345678",style:{flex:1,padding:"0.6rem",border:"1px solid #333",background:d===i.id?"#1a1a1a":"#0d0d0d",color:"#f5f5f5",borderRadius:"4px",fontSize:"0.95rem",opacity:d===i.id?1:.7}}),d===i.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>a(i.id,m),disabled:n,title:"Guardar",children:"ðŸ’¾"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:w,disabled:n,title:"Cancelar",children:"âœ•"})]}):e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>g(i),disabled:n||d!==null,title:"Editar",children:"âœï¸"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>f(C,-1),disabled:n||C===0,title:"Mover arriba",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>f(C,1),disabled:n||C===s.length-1,title:"Mover abajo",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>b(i),disabled:n,title:i.active?"Visible en footer":"Oculto en footer",children:i.active?"ðŸ‘":"ðŸ”’"})]})]},i.id))]}),e.jsxs("div",{children:[e.jsxs("h3",{style:{color:"#f5c400",fontSize:"1.1rem",marginBottom:"1rem",borderBottom:"1px solid #333",paddingBottom:"0.5rem"},children:["ðŸŒ Redes Sociales (",u.length,")"]}),u.length===0?e.jsx("p",{style:{color:"#888",fontSize:"0.9rem"},children:"No hay redes sociales configuradas"}):u.map((i,C)=>e.jsxs("div",{className:"item-card",style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#f5c400",fontSize:"0.9rem"},children:i.name}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",value:p===i.id?S:i.url,onChange:v=>r(v.target.value),disabled:p!==i.id,placeholder:"https://...",style:{flex:1,padding:"0.6rem",border:"1px solid #333",background:p===i.id?"#1a1a1a":"#0d0d0d",color:"#f5f5f5",borderRadius:"4px",fontSize:"0.95rem",opacity:p===i.id?1:.7}}),p===i.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>_(i.id,S),disabled:n,title:"Guardar",children:"ðŸ’¾"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:E,disabled:n,title:"Cancelar",children:"âœ•"})]}):e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>N(i),disabled:n||p!==null,title:"Editar",children:"âœï¸"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>z(C,-1),disabled:n||C===0,title:"Mover arriba",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>z(C,1),disabled:n||C===u.length-1,title:"Mover abajo",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>L(i),disabled:n,title:i.active?"Activa":"Inactiva",children:i.active?"ðŸ‘":"ðŸ”’"})]})]},i.id))]})]})]})}function ce(){const[s,j]=c.useState([]),[u,h]=c.useState(!1),n=async()=>{h(!0);const{data:t,error:m}=await k.from("site_sections").select("*").order("position");if(m){console.error("Error loading sections:",m),h(!1);return}j(t),h(!1)};c.useEffect(()=>{n()},[]);const o=async t=>{h(!0),await k.from("site_sections").update({active:!t.active}).eq("id",t.id),n()},d=async(t,m)=>{const x=t+m;if(x<0||x>=s.length)return;const p=s[t],y=s[x];h(!0),await k.from("site_sections").update({position:-1}).eq("id",p.id),await k.from("site_sections").update({position:p.position}).eq("id",y.id),await k.from("site_sections").update({position:y.position}).eq("id",p.id),n()};return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:[" Secciones del Sitio (",s.length,")"]})}),u?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay secciones"})]}):e.jsx("div",{className:"admin-card-body",children:s.map((t,m)=>e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#f5c400",fontSize:"1.05rem"},children:t.label}),e.jsx("p",{style:{color:"#999",fontSize:"0.85rem",margin:"0.3rem 0 0 0"},children:t.key}),!t.active&&e.jsx("span",{className:"badge badge-inactive",children:"Inactivo"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>d(m,-1),disabled:u||m===0,title:"Subir",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>d(m,1),disabled:u||m===s.length-1,title:"Bajar",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>o(t),disabled:u,children:t.active?"ðŸ‘":"ðŸš«"})]})]},t.id))})]})}function D(){const[s,j]=c.useState([]),[u,h]=c.useState(!1),n=async()=>{h(!0);const t=await X();j(t),h(!1)};c.useEffect(()=>{n()},[]);const o=async t=>{await Y(t),n()},d=async t=>{window.confirm("Â¿Eliminar este mensaje?")&&(await Z(t),n())};return e.jsx("div",{children:e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:" Mensajes de Chat"})}),u?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando mensajes..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay mensajes"})]}):e.jsx("div",{className:"admin-card-body",children:s.map(t=>e.jsxs("div",{className:"message-item",children:[e.jsxs("div",{className:"message-header",children:[e.jsx("strong",{style:{color:"#f5c400"},children:t.name}),e.jsx("span",{style:{fontSize:"0.85rem",color:"#bbb"},children:t.email})]}),e.jsx("p",{style:{margin:"0.8rem 0",lineHeight:"1.6"},children:t.message}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[!t.read&&e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>o(t.id),children:"âœ“ Marcar leÃ­do"}),t.read&&e.jsx("span",{className:"badge badge-active",children:"LeÃ­do"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>d(t.id),children:"ðŸ—‘ Eliminar"})]})]},t.id))})]})})}function de(){const[s,j]=c.useState(""),[u,h]=c.useState(!0),[n,o]=c.useState(!1),[d,t]=c.useState(""),m=c.useRef(null);c.useEffect(()=>{x()},[]);const x=async()=>{h(!0);try{console.log("ðŸ“– AboutAdmin: Cargando contenido...");const r=await ee();console.log("ðŸ“– AboutAdmin: Contenido recibido:",r?.substring(0,100)),j(r)}catch(r){console.error("ðŸ“– AboutAdmin: Error al cargar:",r),t("âŒ Error al cargar el contenido: "+r.message)}finally{h(!1)}},p=async r=>{r.preventDefault(),o(!0),t("");try{console.log("ðŸ’¾ AboutAdmin: Guardando contenido...",{length:s.length}),await te(s),console.log("ðŸ’¾ AboutAdmin: Guardado exitoso"),t(" Contenido actualizado correctamente"),setTimeout(()=>t(""),3e3)}catch(l){console.error("ðŸ’¾ AboutAdmin: Error al guardar:",l),t("âŒ Error al guardar: "+l.message)}finally{o(!1)}},y=r=>{const l=m.current;if(!l)return;const g=l.selectionStart,w=l.selectionEnd,a=s.substring(g,w);if(a){const b=s.substring(0,g),f=s.substring(w),N=`${b}<${r}>${a}</${r}>${f}`;j(N),setTimeout(()=>{l.focus();const E=g+r.length+2+a.length;l.setSelectionRange(E,E)},0)}},S=(r,l="")=>{const g=m.current;if(!g)return;const w=g.selectionStart,a=g.selectionEnd,b=s.substring(0,w),f=s.substring(a),N=`${b}${r}${l}${f}`;j(N),setTimeout(()=>{g.focus();const E=w+r.length;g.setSelectionRange(E,E)},0)};return u?e.jsx("div",{className:"admin-loading",children:"Cargando..."}):e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:" Editar Acerca de"})}),e.jsxs("div",{className:"admin-preview",children:[e.jsx("h3",{children:"Vista Previa"}),e.jsx("div",{className:"about-preview-content",dangerouslySetInnerHTML:{__html:s}})]}),e.jsxs("form",{onSubmit:p,className:"admin-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"about-content",children:"Contenido HTML"}),e.jsxs("div",{className:"text-editor-toolbar",children:[e.jsx("button",{type:"button",onClick:()=>y("strong"),title:"Negrita",className:"toolbar-btn",children:e.jsx("strong",{children:"B"})}),e.jsx("button",{type:"button",onClick:()=>y("em"),title:"Cursiva",className:"toolbar-btn",children:e.jsx("em",{children:"I"})}),e.jsx("button",{type:"button",onClick:()=>y("s"),title:"Tachado",className:"toolbar-btn",children:e.jsx("s",{children:"S"})}),e.jsx("span",{className:"toolbar-divider",children:"|"}),e.jsx("button",{type:"button",onClick:()=>y("h2"),title:"TÃ­tulo 2",className:"toolbar-btn",children:"H2"}),e.jsx("button",{type:"button",onClick:()=>y("h3"),title:"TÃ­tulo 3",className:"toolbar-btn",children:"H3"}),e.jsx("button",{type:"button",onClick:()=>y("p"),title:"PÃ¡rrafo",className:"toolbar-btn",children:"P"}),e.jsx("span",{className:"toolbar-divider",children:"|"}),e.jsx("button",{type:"button",onClick:()=>S("<br>"),title:"Salto de lÃ­nea",className:"toolbar-btn",children:"BR"}),e.jsx("button",{type:"button",onClick:()=>S("<small>","</small>"),title:"Texto pequeÃ±o",className:"toolbar-btn",children:e.jsx("small",{children:"small"})})]}),e.jsx("textarea",{ref:m,id:"about-content",value:s,onChange:r=>j(r.target.value),rows:20,className:"admin-textarea",placeholder:"Escribe el contenido en HTML..."}),e.jsx("small",{className:"form-hint",children:"Selecciona texto y usa la barra de herramientas para aplicar formato HTML"})]}),d&&e.jsx("div",{className:`admin-message ${d.includes("")?"success":"error"}`,children:d}),e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Guardando...":"ðŸ’¾ Guardar Cambios"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:x,disabled:n,children:"ðŸ”„ Recargar"})]})]})]})}const oe=[{id:"chat",label:"Chat",icon:""},{id:"photos",label:"Fotos",icon:""},{id:"sections",label:"Secciones",icon:""},{id:"about",label:"Acerca de",icon:""},{id:"news",label:"Noticias",icon:""},{id:"extra-news",label:"Extra",icon:""},{id:"footer",label:"Footer",icon:""},{id:"donation",label:"Donaciones",icon:""}];function ge(){const[s,j]=c.useState("chat"),[u,h]=c.useState(!1),n=c.useRef(null),o=t=>{j(t),h(!1)};c.useEffect(()=>{const t=m=>{n.current&&!n.current.contains(m.target)&&u&&h(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[u]);const d=()=>{switch(s){case"chat":return e.jsx(D,{});case"photos":return e.jsx(ae,{});case"sections":return e.jsx(ce,{});case"about":return e.jsx(de,{});case"news":return e.jsx(ne,{});case"extra-news":return e.jsx(ie,{});case"footer":return e.jsx(re,{});case"donation":return e.jsx(le,{});default:return e.jsx(D,{})}};return e.jsxs("div",{className:"admin-layout-modern",children:[e.jsx(se,{activeTab:s,setActiveTab:j}),e.jsxs("div",{className:"admin-container",children:[e.jsxs("aside",{className:"admin-sidebar",ref:n,children:[e.jsxs("button",{className:"admin-hamburger",onClick:()=>h(!u),"aria-label":"MenÃº",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("nav",{className:`admin-nav ${u?"active":""}`,children:oe.map(t=>e.jsxs("button",{className:`admin-nav-item ${s===t.id?"active":""}`,onClick:()=>o(t.id),title:t.label,children:[e.jsx("span",{className:"nav-icon",children:t.icon}),e.jsx("span",{className:"nav-label",children:t.label})]},t.id))})]}),e.jsx("main",{className:"admin-content-modern",children:e.jsx("div",{className:"content-wrapper",children:d()})})]})]})}export{ge as default};

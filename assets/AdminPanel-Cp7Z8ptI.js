import{r as c,j as e,s as k,u as L}from"./index-DEFh0cCC.js";import{g as $,u as P,c as V,d as G}from"./newsService-BdMLDnqR.js";import{g as H,u as I,c as U,d as W}from"./extraNewsService-CW4Kge0Z.js";import{c as O,u as B,r as K,d as J,e as Q,f as F,t as M,h as D}from"./donationService-D42cCQ0F.js";import{g as X,m as Y,d as Z}from"./chatService-ocelbMAD.js";import{g as ee,u as te}from"./aboutService-BPKiHLMI.js";const T="trendemedianoche_assets";function ae(){const[s,j]=c.useState([]),[h,u]=c.useState(null),[n,o]=c.useState(""),[d,a]=c.useState(""),[m,x]=c.useState(!1),p=c.useRef(null),y=t=>{const b=t.split("/").pop();return b.length>20?`${b.slice(0,12)}â€¦${b.slice(-6)}`:b},S=async()=>{x(!0);const{data:t,error:b}=await k.from("gallery_images").select("*").order("position",{ascending:!0});if(b){o("Error cargando imÃ¡genes"),a("error"),x(!1);return}const f=await Promise.all(t.map(async N=>{const{data:E}=await k.storage.from(T).createSignedUrl(N.path,3600);return E?{...N,url:E.signedUrl}:null}));j(f.filter(Boolean)),x(!1)};c.useEffect(()=>{S()},[]);const r=async()=>{if(!h){o("Selecciona una imagen"),a("error");return}x(!0);const t=`images/${Date.now()}-${h.name}`,{error:b}=await k.storage.from(T).upload(t,h);if(b){o(b.message),a("error"),x(!1);return}const f=Math.max(0,...s.map(N=>N.position||0));await k.from("gallery_images").insert({path:t,position:f+1,active:!0}),u(null),o("âœ“ Imagen subida correctamente"),a("success"),p.current&&(p.current.value=""),S()},l=async t=>{x(!0),await k.from("gallery_images").update({active:!t.active}).eq("id",t.id),S()},g=async(t,b)=>{const f=t+b;if(f<0||f>=s.length)return;const N=s[t],E=s[f];x(!0),await k.from("gallery_images").update({position:-1}).eq("id",N.id),await k.from("gallery_images").update({position:N.position}).eq("id",E.id),await k.from("gallery_images").update({position:E.position}).eq("id",N.id),S()},w=async t=>{window.confirm("Â¿Eliminar esta imagen?")&&(x(!0),await k.storage.from(T).remove([t.path]),await k.from("gallery_images").delete().eq("id",t.id),o("âœ“ Imagen eliminada"),a("success"),S())};return e.jsxs("div",{children:[n&&e.jsx("div",{className:`admin-alert alert-${d}`,children:n}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:" GalerÃ­a"})}),e.jsx("div",{className:"admin-card-body",children:e.jsxs("div",{className:"admin-form",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"photo-upload",children:"Seleccionar Imagen"}),e.jsx("input",{id:"photo-upload",type:"file",ref:p,onChange:t=>u(t.target.files?.[0]||null),disabled:m,accept:"image/*"})]}),h&&e.jsxs("div",{className:"item-card",style:{borderLeft:"4px solid #00a300"},children:[e.jsx("strong",{children:"Archivo seleccionado:"}),e.jsx("p",{children:y(h.name)})]}),e.jsx("button",{className:"btn btn-primary btn-block",onClick:r,disabled:!h||m,children:m?"â³ Subiendo...":"ðŸ“¤ Subir Imagen"})]})})]}),e.jsxs("div",{className:"admin-card",style:{marginTop:"2rem"},children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:["ImÃ¡genes (",s.length,")"]})}),s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay imÃ¡genes en la galerÃ­a"})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1.5rem",padding:"1.5rem"},children:s.map((t,b)=>e.jsxs("div",{className:"item-card",style:{display:"flex",flexDirection:"column",padding:"1rem",background:"linear-gradient(180deg, #1a1a1a, #0f0f0f)",border:"1px solid #333",borderRadius:"8px"},children:[t.url&&e.jsx("img",{src:t.url,alt:t.path,style:{width:"100%",height:"180px",objectFit:"cover",borderRadius:"6px",marginBottom:"1rem",opacity:t.active?1:.5,border:t.active?"2px solid #f5c400":"2px solid #555"}}),e.jsxs("div",{style:{marginBottom:"0.8rem"},children:[e.jsx("strong",{style:{fontSize:"0.9rem",color:"#f5f5f5"},children:y(t.path)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.3rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"#aaa"},children:new Date(t.created_at).toLocaleDateString()}),!t.active&&e.jsx("span",{className:"badge badge-inactive",style:{fontSize:"0.7rem",padding:"0.2rem 0.5rem",background:"rgba(255,0,0,0.2)",color:"#ff6b6b",borderRadius:"4px"},children:"Inactiva"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,-1),disabled:m||b===0,title:"Mover a la izquierda",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"â¬…"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,1),disabled:m||b===s.length-1,title:"Mover a la derecha",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"âž¡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>l(t),disabled:m,title:t.active?"Ocultar imagen":"Mostrar imagen",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:t.active?"ðŸ‘":"ðŸš«"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>w(t),disabled:m,title:"Eliminar imagen",style:{padding:"0.6rem",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"ðŸ—‘"})]})]},t.id))})]})]})}function se({activeTab:s,setActiveTab:j,role:h}){const{user:u}=L(),[n,o]=c.useState(null);c.useEffect(()=>{u&&d()},[u]);const d=async()=>{const{data:p}=await k.from("profiles").select("name, role").eq("id",u.id).single();p&&o(p)},a=async()=>{await k.auth.signOut(),window.location.href="/#/login"},m=n?.name||u?.email?.split("@")[0]||"Admin",x=n?.role==="admin"?"Administrador":"Usuario";return e.jsxs("header",{className:"admin-header-modern",children:[e.jsxs("div",{className:"admin-header-left",children:[e.jsxs("div",{className:"admin-logo-combo",children:[e.jsx("div",{className:"admin-logo-icon"}),e.jsx("div",{className:"admin-logo-text"})]}),e.jsxs("div",{className:"admin-title-section",children:[e.jsx("h1",{className:"admin-title",children:"Panel de Control"}),e.jsx("p",{className:"admin-subtitle",children:"GestiÃ³n de Contenido"})]})]}),e.jsxs("div",{className:"admin-header-right",children:[e.jsxs("div",{className:"admin-user-info",children:[e.jsx("span",{className:"user-icon",children:"ðŸ‘¤"}),e.jsxs("div",{className:"user-details",children:[e.jsx("span",{className:"user-name",children:m}),e.jsx("span",{className:"user-role",children:x})]})]}),e.jsx("button",{className:"logout-btn",onClick:a,children:"ðŸšª Cerrar sesiÃ³n"})]})]})}function ne(){const[s,j]=c.useState([]),[h,u]=c.useState(null),[n,o]=c.useState(!1),[d,a]=c.useState({title:"",content:"",date:""}),m=async()=>{o(!0);const r=await $();j(r),o(!1)};c.useEffect(()=>{m()},[]);const x=()=>{u(null),a({title:"",content:"",date:""})},p=async r=>{r.preventDefault(),o(!0),h?await P(h.id,d):await V(d),x(),m()},y=r=>{u(r),a({title:r.title,content:r.content,date:r.date})},S=async r=>{window.confirm("Â¿Eliminar noticia?")&&(o(!0),await G(r),m())};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:h?"âœï¸ Editar":" Nueva Noticia"})}),e.jsxs("form",{className:"admin-form",onSubmit:p,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title",children:"TÃ­tulo"}),e.jsx("input",{id:"title",type:"text",placeholder:"TÃ­tulo de la noticia",value:d.title,onChange:r=>a({...d,title:r.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"content",children:"Contenido"}),e.jsx("textarea",{id:"content",placeholder:"Contenido de la noticia",value:d.content,onChange:r=>a({...d,content:r.target.value}),required:!0,style:{minHeight:"150px"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"date",children:"Fecha"}),e.jsx("input",{id:"date",type:"date",value:d.date,onChange:r=>a({...d,date:r.target.value}),required:!0})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"submit",className:"btn btn-primary btn-block",disabled:n,children:n?"â³ Guardando...":h?"âœ“ Actualizar":"âœ“ Crear"}),h&&e.jsx("button",{type:"button",className:"btn btn-secondary btn-block",onClick:x,children:"âœ• Cancelar"})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:[" Noticias (",s.length,")"]})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay noticias"})]}):e.jsx("div",{className:"admin-card-body",children:s.map(r=>e.jsxs("div",{className:"item-card",children:[e.jsx("div",{className:"item-header",children:e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#f5c400"},children:r.title}),e.jsx("p",{style:{margin:"0.4rem 0 0 0",color:"#bbb",fontSize:"0.85rem"},children:r.date})]})}),e.jsxs("p",{style:{margin:"0.8rem 0",fontSize:"0.9rem",color:"#ddd",lineHeight:"1.5"},children:[r.content.substring(0,100),"..."]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>y(r),disabled:n,children:"âœï¸ Editar"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>S(r.id),disabled:n,children:"ðŸ—‘ Eliminar"})]})]},r.id))})]})]})}function ie(){const[s,j]=c.useState([]),[h,u]=c.useState(null),[n,o]=c.useState(!1),[d,a]=c.useState({icon:"",content:"",active:!0}),m=async()=>{o(!0);const l=await H();j(l),o(!1)};c.useEffect(()=>{m()},[]);const x=async l=>{if(l.preventDefault(),o(!0),h)await I(h.id,d);else{const g=s.length>0?Math.max(...s.map(w=>w.position))+1:1;await U({...d,position:g})}a({icon:"",content:"",active:!0}),u(null),m()},p=l=>{u(l),a({icon:l.icon,content:l.content,active:l.active})},y=async l=>{window.confirm("Â¿Eliminar?")&&(o(!0),await W(l),m())},S=async l=>{o(!0),await I(l.id,{active:!l.active}),m()},r=async(l,g)=>{const w=l+g;if(w<0||w>=s.length)return;const t=s[l],b=s[w];o(!0),await I(t.id,{position:-1}),await I(b.id,{position:t.position}),await I(t.id,{position:b.position}),m()};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:h?"âœï¸ Editar":" Nueva Extra"})}),e.jsxs("form",{className:"admin-form",onSubmit:x,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"icon",children:"Icono"}),e.jsx("input",{id:"icon",type:"text",placeholder:"Ej: ðŸ”¥ ðŸ“… âš¡",value:d.icon,onChange:l=>a({...d,icon:l.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"content",children:"Contenido"}),e.jsx("textarea",{id:"content",placeholder:"Contenido del anuncio",value:d.content,onChange:l=>a({...d,content:l.target.value}),required:!0,style:{minHeight:"100px"}})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.95rem",color:"#f5c400",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:d.active,onChange:l=>a({...d,active:l.target.checked})}),"Activo"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"submit",className:"btn btn-primary btn-block",disabled:n,children:n?"â³ Guardando...":h?"âœ“ Actualizar":"âœ“ Crear"}),h&&e.jsx("button",{type:"button",className:"btn btn-secondary btn-block",onClick:()=>{u(null),a({icon:"",content:"",active:!0})},children:"âœ• Cancelar"})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:[" Extra (",s.length,")"]})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay extras"})]}):e.jsx("div",{className:"admin-card-body",children:s.map((l,g)=>e.jsxs("div",{className:"item-card",children:[e.jsx("div",{className:"item-header",children:e.jsxs("div",{children:[e.jsxs("strong",{style:{color:"#f5c400",fontSize:"1.1rem"},children:[l.icon," ",l.content.substring(0,40),"..."]}),!l.active&&e.jsx("span",{className:"badge badge-inactive",children:"Inactivo"})]})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(g,-1),disabled:n||g===0,title:"Subir",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(g,1),disabled:n||g===s.length-1,title:"Bajar",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>S(l),disabled:n,children:l.active?"ðŸ‘":"ðŸš«"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>p(l),disabled:n,children:"âœï¸"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>y(l.id),disabled:n,children:"ðŸ—‘"})]})]},l.id))})]})]})}function le(){const[s,j]=c.useState([]),[h,u]=c.useState(null),[n,o]=c.useState(!1),[d,a]=c.useState(null),[m,x]=c.useState("");c.useEffect(()=>{p()},[]);const p=async()=>{o(!0);const t=await O();j(t.fields),u(t.methodId),o(!1)},y=async t=>{o(!0),await B(t.id,{visible:!t.visible}),p()},S=async(t,b)=>{o(!0),await B(t,{field_value:b}),a(null),x(""),p()},r=t=>{a(t.id),x(t.field_value)},l=()=>{a(null),x("")},g=async(t,b)=>{const f=[...s],N=t+b;N<0||N>=f.length||([f[t],f[N]]=[f[N],f[t]],o(!0),j(f),await K(f),p())},w=async t=>{window.confirm("Â¿Eliminar campo?")&&(o(!0),await J(t),p())};return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:["ðŸ’° Datos de DonaciÃ³n (",s.length,")"]})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:"ðŸ’³"}),e.jsx("p",{className:"empty-state-text",children:"No hay datos de donaciÃ³n configurados"})]}):e.jsx("div",{className:"admin-card-body",children:s.map((t,b)=>e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#f5c400",fontSize:"0.9rem"},children:t.field_key}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",value:d===t.id?m:t.field_value,onChange:f=>x(f.target.value),disabled:d!==t.id,style:{flex:1,padding:"0.6rem",border:"1px solid #333",background:d===t.id?"#1a1a1a":"#0d0d0d",color:"#f5f5f5",borderRadius:"4px",fontSize:"0.95rem",opacity:d===t.id?1:.7}}),d===t.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>S(t.id,m),disabled:n,title:"Guardar",children:"ðŸ’¾"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:l,disabled:n,title:"Cancelar",children:"âœ•"})]}):e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>r(t),disabled:n||d!==null,title:"Editar",children:"âœï¸"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,-1),disabled:n||b===0,title:"Subir",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>g(b,1),disabled:n||b===s.length-1,title:"Bajar",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>y(t),disabled:n,title:t.visible?"Visible":"Oculto",children:t.visible?"ðŸ‘":"ðŸš«"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>w(t.id),disabled:n,title:"Eliminar",children:"ðŸ—‘"})]})]},t.id))})]})}function re(){const[s,j]=c.useState([]),[h,u]=c.useState([]),[n,o]=c.useState(!1),[d,a]=c.useState(null),[m,x]=c.useState(""),[p,y]=c.useState(null),[S,r]=c.useState("");c.useEffect(()=>{l()},[]);const l=async()=>{o(!0);const i=await Q(),C=i.filter(A=>["email","phone"].includes(A.type)),v=i.filter(A=>A.type==="social");j(C),u(v),o(!1)},g=i=>{a(i.id),x(i.url)},w=()=>{a(null),x("")},t=async(i,C)=>{o(!0),await F(i,{url:C}),a(null),x(""),l()},b=async i=>{o(!0),await M(i.id,!i.active),l()},f=async(i,C)=>{const v=[...s],A=i+C;A<0||A>=v.length||([v[i],v[A]]=[v[A],v[i]],o(!0),j(v),await D(v),l())},N=i=>{y(i.id),r(i.url)},E=()=>{y(null),r("")},R=async(i,C)=>{o(!0),await F(i,{url:C}),y(null),r(""),l()},q=async i=>{o(!0),await M(i.id,!i.active),l()},z=async(i,C)=>{const v=[...h],A=i+C;A<0||A>=v.length||([v[i],v[A]]=[v[A],v[i]],o(!0),u(v),await D(v),l())};return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:"âš™ï¸ ConfiguraciÃ³n del Footer"})}),n?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):e.jsxs("div",{className:"admin-card-body",children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{color:"#f5c400",fontSize:"1.1rem",marginBottom:"1rem",borderBottom:"1px solid #333",paddingBottom:"0.5rem"},children:["ðŸ“§ Datos de Contacto (",s.length,")"]}),s.length===0?e.jsx("p",{style:{color:"#888",fontSize:"0.9rem"},children:"No hay datos de contacto configurados"}):s.map((i,C)=>e.jsxs("div",{className:"item-card",style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#f5c400",fontSize:"0.9rem"},children:i.name}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",value:d===i.id?m:i.url,onChange:v=>x(v.target.value),disabled:d!==i.id,placeholder:i.type==="email"?"correo@ejemplo.com":"56912345678",style:{flex:1,padding:"0.6rem",border:"1px solid #333",background:d===i.id?"#1a1a1a":"#0d0d0d",color:"#f5f5f5",borderRadius:"4px",fontSize:"0.95rem",opacity:d===i.id?1:.7}}),d===i.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>t(i.id,m),disabled:n,title:"Guardar",children:"ðŸ’¾"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:w,disabled:n,title:"Cancelar",children:"âœ•"})]}):e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>g(i),disabled:n||d!==null,title:"Editar",children:"âœï¸"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>f(C,-1),disabled:n||C===0,title:"Mover arriba",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>f(C,1),disabled:n||C===s.length-1,title:"Mover abajo",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>b(i),disabled:n,title:i.active?"Visible en footer":"Oculto en footer",children:i.active?"ðŸ‘":"ðŸ”’"})]})]},i.id))]}),e.jsxs("div",{children:[e.jsxs("h3",{style:{color:"#f5c400",fontSize:"1.1rem",marginBottom:"1rem",borderBottom:"1px solid #333",paddingBottom:"0.5rem"},children:["ðŸŒ Redes Sociales (",h.length,")"]}),h.length===0?e.jsx("p",{style:{color:"#888",fontSize:"0.9rem"},children:"No hay redes sociales configuradas"}):h.map((i,C)=>e.jsxs("div",{className:"item-card",style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#f5c400",fontSize:"0.9rem"},children:i.name}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",value:p===i.id?S:i.url,onChange:v=>r(v.target.value),disabled:p!==i.id,placeholder:"https://...",style:{flex:1,padding:"0.6rem",border:"1px solid #333",background:p===i.id?"#1a1a1a":"#0d0d0d",color:"#f5f5f5",borderRadius:"4px",fontSize:"0.95rem",opacity:p===i.id?1:.7}}),p===i.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>R(i.id,S),disabled:n,title:"Guardar",children:"ðŸ’¾"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:E,disabled:n,title:"Cancelar",children:"âœ•"})]}):e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>N(i),disabled:n||p!==null,title:"Editar",children:"âœï¸"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>z(C,-1),disabled:n||C===0,title:"Mover arriba",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>z(C,1),disabled:n||C===h.length-1,title:"Mover abajo",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>q(i),disabled:n,title:i.active?"Activa":"Inactiva",children:i.active?"ðŸ‘":"ðŸ”’"})]})]},i.id))]})]})]})}function ce(){const[s,j]=c.useState([]),[h,u]=c.useState(!1),n=async()=>{u(!0);const{data:a,error:m}=await k.from("site_sections").select("*").order("position");if(m){console.error("Error loading sections:",m),u(!1);return}j(a),u(!1)};c.useEffect(()=>{n()},[]);const o=async a=>{u(!0),await k.from("site_sections").update({active:!a.active}).eq("id",a.id),n()},d=async(a,m)=>{const x=a+m;if(x<0||x>=s.length)return;const p=s[a],y=s[x];u(!0),await k.from("site_sections").update({position:-1}).eq("id",p.id),await k.from("site_sections").update({position:p.position}).eq("id",y.id),await k.from("site_sections").update({position:y.position}).eq("id",p.id),n()};return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("h2",{className:"admin-card-title",children:[" Secciones del Sitio (",s.length,")"]})}),h?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay secciones"})]}):e.jsx("div",{className:"admin-card-body",children:s.map((a,m)=>e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#f5c400",fontSize:"1.05rem"},children:a.label}),e.jsx("p",{style:{color:"#999",fontSize:"0.85rem",margin:"0.3rem 0 0 0"},children:a.key}),!a.active&&e.jsx("span",{className:"badge badge-inactive",children:"Inactivo"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>d(m,-1),disabled:h||m===0,title:"Subir",children:"â¬†"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>d(m,1),disabled:h||m===s.length-1,title:"Bajar",children:"â¬‡"}),e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>o(a),disabled:h,children:a.active?"ðŸ‘":"ðŸš«"})]})]},a.id))})]})}function _(){const[s,j]=c.useState([]),[h,u]=c.useState(!1),n=async()=>{u(!0);const a=await X();j(a),u(!1)};c.useEffect(()=>{n()},[]);const o=async a=>{await Y(a),n()},d=async a=>{window.confirm("Â¿Eliminar este mensaje?")&&(await Z(a),n())};return e.jsx("div",{children:e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:" Mensajes de Chat"})}),h?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{className:"empty-state-text",children:"Cargando mensajes..."})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-text",children:"No hay mensajes"})]}):e.jsx("div",{className:"admin-card-body",children:s.map(a=>e.jsxs("div",{className:"message-item",children:[e.jsxs("div",{className:"message-header",children:[e.jsx("strong",{style:{color:"#f5c400"},children:a.name}),e.jsx("span",{style:{fontSize:"0.85rem",color:"#bbb"},children:a.email})]}),e.jsx("p",{style:{margin:"0.8rem 0",lineHeight:"1.6"},children:a.message}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[!a.read&&e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>o(a.id),children:"âœ“ Marcar leÃ­do"}),a.read&&e.jsx("span",{className:"badge badge-active",children:"LeÃ­do"}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>d(a.id),children:"ðŸ—‘ Eliminar"})]})]},a.id))})]})})}function de(){const[s,j]=c.useState(""),[h,u]=c.useState(!0),[n,o]=c.useState(!1),[d,a]=c.useState(""),m=c.useRef(null);c.useEffect(()=>{x()},[]);const x=async()=>{u(!0);try{console.log("ðŸ“– AboutAdmin: Cargando contenido...");const r=await ee();console.log("ðŸ“– AboutAdmin: Contenido recibido:",r?.substring(0,100)),j(r)}catch(r){console.error("ðŸ“– AboutAdmin: Error al cargar:",r),a("âŒ Error al cargar el contenido: "+r.message)}finally{u(!1)}},p=async r=>{r.preventDefault(),o(!0),a("");try{console.log("ðŸ’¾ AboutAdmin: Guardando contenido...",{length:s.length}),await te(s),console.log("ðŸ’¾ AboutAdmin: Guardado exitoso"),a(" Contenido actualizado correctamente"),setTimeout(()=>a(""),3e3)}catch(l){console.error("ðŸ’¾ AboutAdmin: Error al guardar:",l),a("âŒ Error al guardar: "+l.message)}finally{o(!1)}},y=r=>{const l=m.current;if(!l)return;const g=l.selectionStart,w=l.selectionEnd,t=s.substring(g,w);if(t){const b=s.substring(0,g),f=s.substring(w),N=`${b}<${r}>${t}</${r}>${f}`;j(N),setTimeout(()=>{l.focus();const E=g+r.length+2+t.length;l.setSelectionRange(E,E)},0)}},S=(r,l="")=>{const g=m.current;if(!g)return;const w=g.selectionStart,t=g.selectionEnd,b=s.substring(0,w),f=s.substring(t),N=`${b}${r}${l}${f}`;j(N),setTimeout(()=>{g.focus();const E=w+r.length;g.setSelectionRange(E,E)},0)};return h?e.jsx("div",{className:"admin-loading",children:"Cargando..."}):e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h2",{className:"admin-card-title",children:" Editar Acerca de"})}),e.jsxs("div",{className:"admin-preview",children:[e.jsx("h3",{children:"Vista Previa"}),e.jsx("div",{className:"about-preview-content",dangerouslySetInnerHTML:{__html:s}})]}),e.jsxs("form",{onSubmit:p,className:"admin-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"about-content",children:"Contenido HTML"}),e.jsxs("div",{className:"text-editor-toolbar",children:[e.jsx("button",{type:"button",onClick:()=>y("strong"),title:"Negrita",className:"toolbar-btn",children:e.jsx("strong",{children:"B"})}),e.jsx("button",{type:"button",onClick:()=>y("em"),title:"Cursiva",className:"toolbar-btn",children:e.jsx("em",{children:"I"})}),e.jsx("button",{type:"button",onClick:()=>y("s"),title:"Tachado",className:"toolbar-btn",children:e.jsx("s",{children:"S"})}),e.jsx("span",{className:"toolbar-divider",children:"|"}),e.jsx("button",{type:"button",onClick:()=>y("h2"),title:"TÃ­tulo 2",className:"toolbar-btn",children:"H2"}),e.jsx("button",{type:"button",onClick:()=>y("h3"),title:"TÃ­tulo 3",className:"toolbar-btn",children:"H3"}),e.jsx("button",{type:"button",onClick:()=>y("p"),title:"PÃ¡rrafo",className:"toolbar-btn",children:"P"}),e.jsx("span",{className:"toolbar-divider",children:"|"}),e.jsx("button",{type:"button",onClick:()=>S("<br>"),title:"Salto de lÃ­nea",className:"toolbar-btn",children:"BR"}),e.jsx("button",{type:"button",onClick:()=>S("<small>","</small>"),title:"Texto pequeÃ±o",className:"toolbar-btn",children:e.jsx("small",{children:"small"})})]}),e.jsx("textarea",{ref:m,id:"about-content",value:s,onChange:r=>j(r.target.value),rows:20,className:"admin-textarea",placeholder:"Escribe el contenido en HTML..."}),e.jsx("small",{className:"form-hint",children:"Selecciona texto y usa la barra de herramientas para aplicar formato HTML"})]}),d&&e.jsx("div",{className:`admin-message ${d.includes("")?"success":"error"}`,children:d}),e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Guardando...":"ðŸ’¾ Guardar Cambios"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:x,disabled:n,children:"ðŸ”„ Recargar"})]})]})]})}const oe=[{id:"chat",label:"Chat",icon:""},{id:"photos",label:"Fotos",icon:""},{id:"sections",label:"Secciones",icon:""},{id:"about",label:"Acerca de",icon:""},{id:"news",label:"Noticias",icon:""},{id:"extra-news",label:"Extra",icon:""},{id:"footer",label:"Footer",icon:""},{id:"donation",label:"Donaciones",icon:""}];function ge(){const[s,j]=c.useState("chat"),h=()=>{switch(s){case"chat":return e.jsx(_,{});case"photos":return e.jsx(ae,{});case"sections":return e.jsx(ce,{});case"about":return e.jsx(de,{});case"news":return e.jsx(ne,{});case"extra-news":return e.jsx(ie,{});case"footer":return e.jsx(re,{});case"donation":return e.jsx(le,{});default:return e.jsx(_,{})}};return e.jsxs("div",{className:"admin-layout-modern",children:[e.jsx(se,{activeTab:s,setActiveTab:j}),e.jsxs("div",{className:"admin-container",children:[e.jsx("aside",{className:"admin-sidebar",children:e.jsx("nav",{className:"admin-nav",children:oe.map(u=>e.jsxs("button",{className:`admin-nav-item ${s===u.id?"active":""}`,onClick:()=>j(u.id),title:u.label,children:[e.jsx("span",{className:"nav-icon",children:u.icon}),e.jsx("span",{className:"nav-label",children:u.label})]},u.id))})}),e.jsx("main",{className:"admin-content-modern",children:e.jsx("div",{className:"content-wrapper",children:h()})})]})]})}export{ge as default};
